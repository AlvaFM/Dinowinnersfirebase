<ion-header>
  <ion-toolbar class="ion-toolbar">
    <ion-title>Perfil</ion-title>

    <div *ngIf="nombreUsuario" slot="start">
      <span>{{nombreUsuario}}</span>
    </div>

    <ion-icon name="log-out" (click)="logout()" slot="end" *ngIf="nombreUsuario" size="large"></ion-icon>
  </ion-toolbar>
</ion-header>

<ion-content>

  <section *ngIf="selectedTab === 'perfil'" style="padding: 16px;">
    <ion-card>
      <ion-card-header>
        <ion-card-title>{{nombreUsuario}}</ion-card-title>
      </ion-card-header>
  
      <!-- Si no hay perfiles en la lista, mostramos la opción para subir una foto -->
      <ion-card-content *ngIf="perfilList.length === 0">
        <ion-item>
          <input type="file" (change)="onFileSelected($event)" />
        </ion-item>
        <ion-button (click)="addFotoPerfil()">Subir Foto</ion-button>
      </ion-card-content>
  
      <!-- Si hay perfiles en la lista, mostramos las fotos de perfil -->
      <ion-card-content *ngFor="let perfilContenido of perfilList">
        <img *ngIf="perfilContenido.fotoPerfil" [src]="perfilContenido.fotoPerfil" alt="Foto de perfil" />
  
        <p *ngIf="!perfilContenido.fotoPerfil">No tienes una foto de perfil.</p>
      </ion-card-content>
      
    </ion-card>
  </section>
  

  <!-- Seccion de productos  -->
  <section *ngIf="selectedTab === 'productos'" style="padding: 16px;">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Tus productos:</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <div class="profile-product-list">
            <ion-item *ngFor="let product of products" class="profile-product-card">
              <ion-label>
                <h2>{{ product.nombre }} - {{ product.precio | currency }}</h2>
                <h2> {{ product.descripcion }}</h2>
                <img *ngIf="product.imageUrl" [src]="product.imageUrl" alt="Imagen del producto" class="profile-product-image"/>
              </ion-label>
            </ion-item>
          </div>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Agregar Producto</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Nombre del Producto</ion-label>
          <ion-input [(ngModel)]="productName"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Descripción</ion-label>
          <ion-input [(ngModel)]="productDescription"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Precio</ion-label>
          <ion-input [(ngModel)]="productPrice" type="number"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Selecciona una imagen</ion-label>
        </ion-item>
        <ion-item>          
          <input type="file" (change)="onFileSelected($event)" />
        </ion-item>

        <ion-button expand="full" (click)="addProduct()">Agregar Producto</ion-button>
      </ion-card-content>
    </ion-card>
  </section>

  <!-- Sección de ubicaciones -->
  <section *ngIf="selectedTab === 'ubicaciones'" style="padding: 16px;">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Tus ubicaciones:</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let location of locations">
            {{ location.ciudad }} - {{ location.direccion }}
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Agregar Ubicación</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Ciudad</ion-label>
          <ion-input [(ngModel)]="city"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Dirección</ion-label>
          <ion-input [(ngModel)]="address"></ion-input>
        </ion-item>

        <ion-button expand="full" (click)="addLocation()">Agregar Ubicación</ion-button>
      </ion-card-content>
    </ion-card>
  </section>

  <!-- Sección de cursos -->
  <section *ngIf="selectedTab === 'cursos'" style="padding: 16px;">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Cursos que he agregado</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let curso of cursosAgregados">
            {{ curso.NombreCurso }} - Cupos: {{ curso.Cupos }}
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Cursos a los que estoy suscrito</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let curso of cursosSuscritos">
            {{ curso.nombreCursoSub }} - Autor: {{ curso.nameAutor }}
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Agregar Curso</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Nombre del Curso</ion-label>
          <ion-input [(ngModel)]="CursoNombre"></ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Descripción</ion-label>
          <ion-textarea [(ngModel)]="DescripcionCurso" auto-grow="true"></ion-textarea>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Contenido</ion-label>
          <ion-textarea [(ngModel)]="contenidoCurso" auto-grow="true"></ion-textarea>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Cupos Disponibles</ion-label>
          <ion-input [(ngModel)]="CuposCurso" type="number" min="0" step="1"></ion-input>
        </ion-item>

        <ion-button expand="full" (click)="agregarCursoYComentar()">Publicar en foro</ion-button>

      </ion-card-content>
    </ion-card>
  </section>
</ion-content>

<!-- Tab Bar en el footer -->
<ion-footer>
  <ion-tab-bar slot="bottom">
    <ion-tab-button routerLink="/home" (click)="selectedTab = 'perfil'">
      <ion-icon color="warning" name="home"></ion-icon>
      <ion-label >Inicio</ion-label>
    </ion-tab-button>
    <ion-tab-button (click)="selectedTab = 'productos'">
      <ion-icon name="cart"></ion-icon>
      <ion-label>Mis Productos</ion-label>
    </ion-tab-button>
    <ion-tab-button (click)="selectedTab = 'ubicaciones'">
      <ion-icon name="pin"></ion-icon>
      <ion-label>Ubicaciones</ion-label>
    </ion-tab-button>
    <ion-tab-button (click)="selectedTab = 'cursos'">
      <ion-icon name="school"></ion-icon>
      <ion-label>Cursos</ion-label>
    </ion-tab-button>
    <ion-tab-button (click)="selectedTab = 'perfil'">
      <ion-icon color="warning" name="person"></ion-icon>
      <ion-label>Perfil</ion-label>
    </ion-tab-button>
  </ion-tab-bar>
</ion-footer>
